import 'core-js/stable';
import 'regenerator-runtime/runtime';
import { waitForAppScreen, zemu } from './test.fixture';

test('Swap unknown token to native', zemu(async (sim, eth) => {
    // Unknown token to ETH (SWAP 59,519.2 BORING  (custom) to 0.7102458118249031 ETH)
    // https://etherscan.io/tx/0xcfd8edbcfd638fbb20c4edb1a2eb5cdc7fd44ece737d6e7d6a30ab09095464e3
    const tx = eth.signTransaction(
        "44'/60'/0'/0/0",
        'f908ed820f8c85059682f00083038c4b9411111112542d85b3ef69ae05771c2dccff4faa2680b908847c025200000000000000000000000000fd3dfb524b2da40c8a6d703c62be36b5d854062600000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000180000000000000000000000000bc19712feb3a26080ebf6f2f7849b417fdd792ca000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000fd3dfb524b2da40c8a6d703c62be36b5d854062600000000000000000000000040fec832b0ff29a082e95678176e1cc66805f8de000000000000000000000000000000000000000000000c9a8ad3fdc365b0000000000000000000000000000000000000000000000000000009c211279fdca95700000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006e000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000002200000000000000000000000000000000000000000000000000000000000000440800000000000000000000000917c52869df752d784ec73fa0881898f9bfd0fd80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000104128acb08000000000000000000000000fd3dfb524b2da40c8a6d703c62be36b5d85406260000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000c9a8ad3fdc365b0000000000000000000000000000000000000000000000000000000000001000276a400000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000bc19712feb3a26080ebf6f2f7849b417fdd792ca000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000164b3af37c000000000000000000000000000000000000000000000000000000000000000808000000000000000000000000000000000000000000000000000000000000004000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000000000003200000000000000000000000000000032000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000242e1a7d4d00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000001a4b3af37c000000000000000000000000000000000000000000000000000000000000000808000000000000000000000000000000000000000000000000000000000000044000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000000000010000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000064d1660f99000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee00000000000000000000000040fec832b0ff29a082e95678176e1cc66805f8de0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025a05414686b2c62fc8b0aac12ca4402bbbb8e2209ef535ffe56fee8d9475d85b33aa00393b85e98664c0a8af3df2b134af06f3547ff7a014228ba3c608eb54956ad3f',
    );
    await waitForAppScreen(sim);
    await sim.navigateAndCompareSnapshots('.', 'swap_unknown_to_native', [10, 0]);

    await expect(tx).resolves.toEqual({
        r: 'e95c0ee698807e9907eb4575b754e88cbee67fafde52406b8880406f245cb156',
        s: '4162c6bd3059bcf6b2406107c2783bfc338a2c6cc65e12fb2c064508ea0d51e0',
        v: '6e',
    });
}));
